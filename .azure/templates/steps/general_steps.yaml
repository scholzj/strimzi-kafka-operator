# General steps shared accross all pipelines
steps:
- template: 'setup_java.yaml'
  parameters:
    JDK_PATH: $(jdk_path)
    JDK_VERSION: $(jdk_version)

- template: "log_variables.yaml"

- task: DockerInstaller@0
  displayName: Docker Installer
  inputs:
    dockerVersion: 19.03.9
    releaseType: stable

- bash: ".azure/scripts/setup_shellcheck.sh"
  displayName: "Setup Shellcheck"

- bash: ".azure/scripts/install_yq.sh"
  displayName: "Install yq"

- task: UseRubyVersion@0
  inputs:
    versionSpec: '>= 2.4'
    addToPath: true

- bash: gem install asciidoctor
  displayName: 'Install asciidoctor'

- template: "build_strimzi.yaml"

- bash: ".azure/scripts/setup-kubernetes.sh"
  displayName: "Setup Minikube cluster"

- bash: ".azure/scripts/setup-helm.sh"
  displayName: "Setup Helm"
  env:
    TEST_HELM2_VERSION: 'v2.17.0'
    TEST_HELM3_VERSION: 'v3.4.2'
